<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Visualiseur de fichier XLSB</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">
  <div class="container">
    <h1 class="mb-4">Visualiseur de fichier Excel (.xlsb)</h1>
    <input type="file" id="upload" accept=".xlsb" class="form-control mb-4">
    <div id="output" class="table-responsive"></div>
  </div>

  <script>
    document.getElementById('upload').addEventListener('change', handleFile, false);

    function handleFile(e) {
      const file = e.target.files[0];
      const reader = new FileReader();

      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});

        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

        renderTable(jsonData);
      };

      reader.readAsArrayBuffer(file);
    }

    function renderTable(data) {
      const table = document.createElement('table');
      table.className = 'table table-bordered table-striped';

      data.forEach((row, i) => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
          const cellEl = document.createElement(i === 0 ? 'th' : 'td');
          cellEl.textContent = cell != null ? cell : '';
          tr.appendChild(cellEl);
        });
        table.appendChild(tr);
      });

      const output = document.getElementById('output');
      output.innerHTML = '';
      output.appendChild(table);
    }
  </script>
</body>
</html>
